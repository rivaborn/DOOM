# File Overview

`sounds.c` (in the `sndserv` directory) is the sound and music data table file for the DOOM sound server. It defines two global arrays that serve as the complete catalogue of all audio assets in the game:

- `S_music[]` — the table of all music tracks (MUS format lumps from the WAD file)
- `S_sfx[]` — the table of all sound effects (raw PCM data lumps from the WAD file)

This file was originally generated by Dave Taylor's sound utility tool, which parsed the DOOM WAD file and produced this C source as output. It provides the metadata that the sound server needs to load, manage, and play audio assets.

Note that this file is a copy of a similar `sounds.c` in the main `linuxdoom-1.10` directory, trimmed to include only the data that the sound server needs. The two files share the same structure definitions (via `soundst.h` / `sounds.h`) and the same asset list.

The file defines a local `enum { false, true }` because it does not include a header that provides `boolean`, but it does include `sounds.h` which uses these values in `sfxinfo_t` initializers.

RCS version: `$Id: sounds.c,v 1.3 1997/01/29 22:40:44 b1 Exp $`

---

## Global Variables

### `S_music[]`

```c
musicinfo_t S_music[];
```

An array of `musicinfo_t` structures, one per music track in the game. The array is indexed by the `musicenum_t` enumeration defined in `sounds.h`. The first entry (`S_music[mus_None]`) is a null/placeholder entry.

Each entry is initialized with the 6-character lump name used to find the track in the WAD file. The `lumpnum`, `data`, and `handle` fields are initialized to `0` and filled in at runtime.

**Entries (65 total, indexed 0-64):**

| Index | Enum | WAD Lump Name | Description |
|-------|------|---------------|-------------|
| 0 | `mus_None` | (null) | Placeholder |
| 1 | `mus_e1m1` | `"e1m1"` | Knee-Deep in the Dead, Map 1 |
| 2 | `mus_e1m2` | `"e1m2"` | Episode 1, Map 2 |
| 3-9 | `mus_e1m3`-`mus_e1m9` | `"e1m3"`-`"e1m9"` | Episode 1 remaining maps |
| 10-18 | `mus_e2m1`-`mus_e2m9` | `"e2m1"`-`"e2m9"` | Episode 2 |
| 19-27 | `mus_e3m1`-`mus_e3m9` | `"e3m1"`-`"e3m9"` | Episode 3 |
| 28 | `mus_inter` | `"inter"` | Episode intermission |
| 29 | `mus_intro` | `"intro"` | Title screen |
| 30 | `mus_bunny` | `"bunny"` | Bunny screen (DOOM 1 ending) |
| 31 | `mus_victor` | `"victor"` | Victory screen |
| 32 | `mus_introa` | `"introa"` | Alternate intro |
| 33-64 | DOOM II tracks | `"runnin"`, `"stalks"`, etc. | DOOM II episode/level music |

---

### `S_sfx[]`

```c
sfxinfo_t S_sfx[];
```

An array of `sfxinfo_t` structures, one per sound effect in the game. The array is indexed by the `sfxenum_t` enumeration defined in `sounds.h`. The first entry (`S_sfx[sfx_None]`) is a null/placeholder.

Each entry is initialized with:
```
{ name, singularity, priority, link, pitch, volume, data }
```
where `data` is initialized to `0` (filled at runtime by `grabdata` in `soundsrv.c`), and `link` is either `0` (load independently) or a pointer to another `sfxinfo_t` (reuse that entry's data, as used by `sfx_chgun` which links to `sfx_pistol`).

**Selected entries of note:**

| Index | Enum | Name | Singular | Priority | Notes |
|-------|------|------|----------|----------|-------|
| 0 | `sfx_None` | (null) | - | - | Placeholder |
| 1 | `sfx_pistol` | `"pistol"` | false | 64 | Pistol fire |
| 2 | `sfx_shotgn` | `"shotgn"` | false | 64 | Shotgun fire |
| 11 | `sfx_sawidl` | `"sawidl"` | false | 118 | Chainsaw idle (highest priority weapon sound) |
| 18 | `sfx_pstart` | `"pstart"` | false | 100 | Platform start |
| 22 | `sfx_stnmov` | `"stnmov"` | false | 119 | Stone move (highest priority overall) |
| 32 | `sfx_itemup` | `"itemup"` | **true** | 78 | Item pickup (singular) |
| 33 | `sfx_wpnup` | `"wpnup"` | **true** | 78 | Weapon pickup (singular) |
| 86 | `sfx_chgun` | `"chgun"` | false | 64 | Chaingun — **linked** to `S_sfx[sfx_pistol]`, pitch 150, vol 0 |
| 109 | `sfx_radio` | `"radio"` | false | 60 | Radio/communicator sound |

The `singularity` field (when true) means only one instance of this sound can play at a time — starting a new instance stops any existing one.

Priority values range from 32 (lowest, e.g., `sfx_telept`) to 120 (highest, `sfx_posact`, `sfx_bgact`, `sfx_dmact`).

---

## Functions

No functions are defined in this file. It contains only data initializations.

---

## Data Structures

This file uses structures defined in `soundst.h` (via `sounds.h`). See the `soundst.h` documentation for full field descriptions.

### `musicinfo_t` (defined in `soundst.h`)

```c
typedef struct {
    char*  name;      // Up to 6-character WAD lump name
    int    lumpnum;   // WAD lump number (filled at runtime)
    void*  data;      // Pointer to MUS data (filled at runtime)
    int    handle;    // Music playback handle (filled at runtime)
} musicinfo_t;
```

All entries in `S_music[]` initialize only `name`; the rest are `0`.

### `sfxinfo_t` (defined in `soundst.h`)

```c
struct sfxinfo_struct {
    char*        name;         // Up to 6-character WAD lump name (without "DS" prefix)
    int          singularity;  // 1 = only one instance at a time
    int          priority;     // Higher = more important
    sfxinfo_t*   link;         // If non-null, reuse data from linked entry
    int          pitch;        // Pitch shift when linked (or -1)
    int          volume;       // Volume when linked (or -1)
    void*        data;         // Pointer to raw PCM data (filled at runtime)
    int          usefulness;   // Cache eviction counter (unused in sndserv)
    int          lumpnum;      // WAD lump number (filled at runtime)
};
```

In `S_sfx[]`, every entry initializes 7 fields: `name`, `singularity`, `priority`, `link`, `pitch`, `volume`, `data`. The `usefulness` and `lumpnum` fields use the default of `0` (not listed in initializers since the struct has 9 fields but only 7 are explicitly given — the last two default to zero in C aggregate initialization).

---

## Dependencies

| File | Reason |
|------|--------|
| `sounds.h` | Includes `soundst.h` (for `musicinfo_t`, `sfxinfo_t`), declares `musicenum_t` and `sfxenum_t` enumerations used to give entries their names |
